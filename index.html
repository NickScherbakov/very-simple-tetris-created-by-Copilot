<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#7b68ee">
    <meta name="description" content="ĞšĞ»Ğ°ÑÑĞ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¸Ğ³Ñ€Ğ° Tetris Ñ Ğ²Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ²Ğ°Ğ»ÑÑ‚Ğ¾Ğ¹ Ğ¸ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ¾Ğ¹ ÑÑ‚Ğ°Ğ²Ğ¾Ğº">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Tetris PWA">
    
    <title>Tetris PWA - TetriCoins Edition</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/icons/icon-512x512.png">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="css/betting-panel.css">
    <link rel="stylesheet" href="css/language.css">
    <link rel="stylesheet" href="css/team-tournament.css">
</head>
<body>
    <!-- Language Selection Screen -->
    <div class="language-screen" id="language-screen" style="display: none;">
        <h1>ğŸ® Tetris Arena</h1>
        <h2 data-i18n="select_language">Select Language / Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑĞ·Ñ‹Ğº</h2>
        <div class="language-options">
            <button class="language-btn" data-lang="en">ğŸ‡¬ğŸ‡§ English</button>
            <button class="language-btn" data-lang="ar">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
            <button class="language-btn" data-lang="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</button>
            <button class="language-btn" data-lang="ru">ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹</button>
        </div>
    </div>

    <!-- Rules Screen -->
    <div class="rules-screen" id="rules-screen" style="display: none;">
        <h1 data-i18n="rules_title">How to Play</h1>
        <div class="rules-content">
            <div class="rules-section">
                <h3 data-i18n="rules_how_to_play">How to Play</h3>
                <ul>
                    <li data-i18n="rules_arrow_left_right">â† â†’ Arrow keys - Move pieces left/right</li>
                    <li data-i18n="rules_arrow_up">â†‘ Arrow up - Rotate piece</li>
                    <li data-i18n="rules_arrow_down">â†“ Arrow down - Soft drop (speed up)</li>
                    <li data-i18n="rules_space">Space - Hard drop (instant drop)</li>
                    <li data-i18n="rules_mobile">Mobile: Swipes and taps for controls</li>
                </ul>
            </div>

            <div class="rules-section">
                <h3 data-i18n="rules_tetricoins">TetriCoins System:</h3>
                <ul>
                    <li data-i18n="rules_initial_balance">Starting balance: 1000 TC</li>
                    <li data-i18n="rules_daily_bonus">Daily bonus: +100 TC</li>
                    <li data-i18n="rules_line_rewards">Line rewards:</li>
                    <li style="padding-left: 3rem;" data-i18n="rules_1_line">1 line = 10 TC</li>
                    <li style="padding-left: 3rem;" data-i18n="rules_2_lines">2 lines = 30 TC</li>
                    <li style="padding-left: 3rem;" data-i18n="rules_3_lines">3 lines = 100 TC</li>
                    <li style="padding-left: 3rem;" data-i18n="rules_4_lines">4 lines (Tetris) = 500 TC</li>
                </ul>
            </div>

            <div class="rules-section">
                <h3 data-i18n="rules_ai_mode">AI vs AI Mode:</h3>
                <ul>
                    <li data-i18n="rules_ai_betting">Place bets on the winner</li>
                    <li data-i18n="rules_ai_bet_types">4 bet types with different odds</li>
                    <li data-i18n="rules_ai_tournament">Tournament mode with jackpot</li>
                </ul>
            </div>

            <div class="rules-disclaimer">
                <p><strong data-i18n="rules_disclaimer">Disclaimer:</strong></p>
                <p data-i18n="rules_disclaimer_text">This is a game with virtual currency. No real money is used. For entertainment only!</p>
            </div>
        </div>
        <button class="start-game-btn" id="start-playing-btn" data-i18n="start_playing">Start Playing!</button>
    </div>

    <div class="game-container">
        <div class="score-section">
            <div class="score"><span data-i18n="score">Score:</span> <span id="score">0</span></div>
            <div class="level"><span data-i18n="level">Level:</span> <span id="level">1</span></div>
            <div class="lines"><span data-i18n="lines">Lines:</span> <span id="lines">0</span></div>
            <div class="high-score"><span data-i18n="high_score">High Score:</span> <span id="high-score">0</span></div>
            <div class="balance"><span data-i18n="balance">ğŸ’° Balance:</span> <span id="tetricoins-balance">1000</span> TC</div>
        </div>

        <canvas id="tetris-canvas" width="300" height="600"></canvas>

        <div class="next-piece">
            <h3 data-i18n="next">Next:</h3>
            <canvas id="next-piece-canvas" width="100" height="100"></canvas>
        </div>

        <div class="controls-instructions">
            <h3 data-i18n="controls">Controls:</h3>
            <p data-i18n="controls_text">Enter/S: Start Game | Arrow Keys: Move/Drop | Space: Hard Drop | P: Pause | G: Toggle Grid | T: Take Control (AI Mode)</p>
        </div>

        <div class="game-buttons">
            <button id="start-btn" class="button" data-i18n="start_game">Start Game</button>
            <button id="ai-vs-ai-btn" class="button button-primary" data-i18n="ai_vs_ai_mode">AI vs AI Mode</button>
            <button id="tournament-btn" class="button button-tournament" data-i18n="tournament_mode">Tournament Mode</button>
            <button id="team-tournament-btn" class="button button-team-tournament" data-i18n="team_tournament_mode">Team Tournament</button>
            <button id="grid-toggle" class="button button-secondary" data-i18n="hide_grid">Hide Grid</button>
            <button id="install-pwa-btn" class="button button-install" style="display: none;" data-i18n="install_app">Install App</button>
            <button id="achievements-btn" class="button button-achievements" data-i18n="achievements">ğŸ† Achievements</button>
            <button id="share-btn" class="button button-share" data-i18n="share">ğŸ“¤ Share</button>
            <button id="language-change-btn" class="button button-secondary" data-i18n="language_btn">ğŸŒ Language</button>
        </div>

        <div class="ai-insight">
            <h3 data-i18n="ai_insight">AI Insight:</h3>
            <p id="ai-summary" data-i18n="ai_observing">The adaptive engine is observing your moves.</p>
        </div>

        <div class="ai-vs-ai-panel" id="ai-vs-ai-panel" style="display: none;">
            <div class="ai-player ai-player-1">
                <h4 data-i18n="ai_player_1">AI Player 1 (Red)</h4>
                <div class="ai-thinking" id="ai1-thinking" data-i18n="ai_analyzing">AI is analyzing...</div>
                <div class="ai-plan" id="ai1-plan" data-i18n="ai_planning">Planning next move...</div>
            </div>
            <div class="ai-player ai-player-2">
                <h4 data-i18n="ai_player_2">AI Player 2 (Blue)</h4>
                <div class="ai-thinking" id="ai2-thinking" data-i18n="ai_analyzing">AI is analyzing...</div>
                <div class="ai-plan" id="ai2-plan" data-i18n="ai_planning">Planning next move...</div>
            </div>
            <div class="game-controls">
                <button id="take-control-btn" class="button button-warning" data-i18n="take_control">Take Control</button>
                <button id="exit-ai-mode-btn" class="button button-secondary" data-i18n="exit_ai_mode">Exit AI Mode</button>
                <div class="current-turn" id="current-turn" data-i18n="ai_1_turn">AI 1's Turn</div>
            </div>
        </div>
        
        <footer class="game-footer">
            <p data-i18n="footer_disclaimer">ğŸ® This is a game with virtual currency. No real money is used. For entertainment only!</p>
        </footer>
    </div>
    
    <!-- Betting Panel -->
    <div id="betting-panel" class="betting-panel">
        <div class="betting-header">
            <h2 data-i18n="place_bet">ğŸ² Place Your Bet!</h2>
            <div class="betting-countdown-wrapper">
                <p><span data-i18n="time_remaining">Time remaining:</span> <span id="betting-countdown" class="betting-countdown">15</span> <span data-i18n="seconds">sec</span></p>
            </div>
        </div>
        
        <div id="tournament-progress" class="tournament-progress" style="display: none;">
            <h3 data-i18n="tournament">ğŸ† Tournament</h3>
            <div class="match-counter"><span data-i18n="match">Match</span> <span id="current-match">1</span> <span data-i18n="of">of</span> 5</div>
            <div class="jackpot-display">
                <span data-i18n="jackpot">Jackpot:</span> <span class="amount" id="jackpot-amount">0</span> TC
            </div>
        </div>
        
        <div class="bet-types" id="bet-types">
            <div class="bet-type-card" data-bet-type="winner">
                <div class="bet-type-title">
                    <h3 data-i18n="bet_winner">ğŸ† Winner</h3>
                    <span class="bet-odds">2.0x</span>
                </div>
                <div class="bet-type-desc" data-i18n="bet_winner_desc">Bet on the match winner</div>
                <div class="bet-options">
                    <button class="bet-option-btn" data-target="1">AI 1</button>
                    <button class="bet-option-btn" data-target="2">AI 2</button>
                </div>
            </div>
            
            <div class="bet-type-card" data-bet-type="first_tetris">
                <div class="bet-type-title">
                    <h3 data-i18n="bet_first_tetris">âš¡ First Tetris</h3>
                    <span class="bet-odds">5.0x</span>
                </div>
                <div class="bet-type-desc" data-i18n="bet_first_tetris_desc">Who gets 4 lines first</div>
                <div class="bet-options">
                    <button class="bet-option-btn" data-target="1">AI 1</button>
                    <button class="bet-option-btn" data-target="2">AI 2</button>
                </div>
            </div>
            
            <div class="bet-type-card" data-bet-type="score_range">
                <div class="bet-type-title">
                    <h3 data-i18n="bet_score_range">ğŸ¯ Score Range</h3>
                    <span class="bet-odds">3-10x</span>
                </div>
                <div class="bet-type-desc" data-i18n="bet_score_range_desc">Guess the final score range</div>
                <div class="bet-options">
                    <button class="bet-option-btn" data-target="0-1000">0-1000</button>
                    <button class="bet-option-btn" data-target="1001-2000">1001-2000</button>
                    <button class="bet-option-btn" data-target="2001-3000">2001-3000</button>
                    <button class="bet-option-btn" data-target="5001+">5001+</button>
                </div>
            </div>
            
            <div class="bet-type-card" data-bet-type="score_race">
                <div class="bet-type-title">
                    <h3 data-i18n="bet_score_race">ğŸƒ Score Race</h3>
                    <span class="bet-odds">1.5x</span>
                </div>
                <div class="bet-type-desc" data-i18n="bet_score_race_desc">Who reaches 1000 points first</div>
                <div class="bet-options">
                    <button class="bet-option-btn" data-target="1">AI 1</button>
                    <button class="bet-option-btn" data-target="2">AI 2</button>
                </div>
            </div>
        </div>
        
        <div class="bet-amount-section">
            <h3 data-i18n="bet_amount">ğŸ’° Bet Amount:</h3>
            <div class="quick-bet-buttons">
                <button class="quick-bet-btn" data-amount="10">10 TC</button>
                <button class="quick-bet-btn" data-amount="50">50 TC</button>
                <button class="quick-bet-btn" data-amount="100">100 TC</button>
                <button class="quick-bet-btn" data-amount="250">250 TC</button>
                <button class="quick-bet-btn" data-amount="500">500 TC</button>
            </div>
            <div class="custom-bet-input">
                <input type="number" id="custom-bet-amount" placeholder="Custom amount" data-i18n="custom_amount" min="10" max="500">
            </div>
        </div>
        
        <div id="current-bet-display"></div>
        
        <button id="place-bet-btn" class="place-bet-btn" disabled data-i18n="place_bet_btn">Place Bet</button>
        <button id="cancel-bet-btn" class="cancel-bet-btn" data-i18n="skip">Skip</button>
    </div>
    
    <!-- Achievements Modal -->
    <div id="achievements-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-modal" id="close-achievements">&times;</span>
            <h2 data-i18n="achievements_title">ğŸ† Achievements</h2>
            <div class="achievements-progress">
                <p><span data-i18n="achievements_progress">Progress:</span> <span id="achievements-progress">0</span>%</p>
            </div>
            <div id="achievements-list" class="achievements-list"></div>
            <h3 data-i18n="leaderboard">ğŸ“Š Leaderboard</h3>
            <div id="leaderboard" class="leaderboard"></div>
        </div>
    </div>
    
    <!-- Team Tournament Modal -->
    <div id="team-tournament-modal" class="team-tournament-modal">
        <div class="team-tournament-content">
            <button class="team-tournament-close" id="close-team-tournament">&times;</button>
            <div class="team-tournament-header">
                <h2 data-i18n="team_tournament_title">ğŸ† Team Tournament System</h2>
            </div>
            
            <div class="team-tournament-tabs">
                <button class="team-tournament-tab active" data-tab="teams" data-i18n="team_management">Team Management</button>
                <button class="team-tournament-tab" data-tab="setup" data-i18n="tournament_setup">Tournament Setup</button>
                <button class="team-tournament-tab" data-tab="active" data-i18n="active_tournament" style="display: none;">Active Tournament</button>
            </div>
            
            <!-- Team Management Section -->
            <div class="team-tournament-section active" id="teams-section">
                <div class="team-creation-form">
                    <h3 data-i18n="create_team">Create Team</h3>
                    <div class="team-form-group">
                        <label for="team-name-input" data-i18n="team_name">Team Name</label>
                        <input type="text" id="team-name-input" placeholder="Enter team name">
                    </div>
                    <div class="team-form-group">
                        <label for="team-size-input" data-i18n="team_size">Team Size</label>
                        <select id="team-size-input">
                            <option value="2">2 Players</option>
                            <option value="3" selected>3 Players</option>
                            <option value="4">4 Players</option>
                        </select>
                    </div>
                    <button class="team-tournament-btn success" id="create-team-btn" data-i18n="create_team_btn">Create Team</button>
                </div>
                
                <h3 data-i18n="my_teams">My Teams</h3>
                <div class="team-list" id="team-list"></div>
            </div>
            
            <!-- Tournament Setup Section -->
            <div class="team-tournament-section" id="setup-section">
                <div class="tournament-setup">
                    <h3 data-i18n="select_teams">Select Teams for Tournament</h3>
                    <p style="color: #aaa; margin-bottom: 15px;">Click on teams to select them for the tournament (minimum 2 teams)</p>
                    
                    <div class="selected-teams-display" id="selected-teams-display">
                        <p style="color: #888;">No teams selected yet...</p>
                    </div>
                    
                    <div class="team-list" id="team-selection-list"></div>
                    
                    <button class="team-tournament-btn success" id="start-team-tournament-btn" disabled data-i18n="start_tournament">Start Tournament</button>
                </div>
            </div>
            
            <!-- Active Tournament Section -->
            <div class="team-tournament-section" id="active-section">
                <div id="tournament-match-display"></div>
                <div id="tournament-bracket-display"></div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="js/i18n.js"></script>
    <script src="js/language-selector.js"></script>
    <script src="js/currency.js"></script>
    <script src="js/betting.js"></script>
    <script src="js/achievements.js"></script>
    <script src="js/pwa.js"></script>
    <script src="js/team-tournament.js"></script>
    <script src="js/team-tournament-ui.js"></script>
    <script type="module" src="tetris.js"></script>
</body>
</html>
